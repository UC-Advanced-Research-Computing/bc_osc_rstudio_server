---
cluster: "arcc2"
form:
  - custom_queue
  - bc_num_hours
  - bc_num_slots
  - num_cpus
  - num_gpus
  - version
  - custom_element
attributes:
  custom_queue:
    widget: "select"
    label: "Partition"
    options:
      - ["Public", "public"]
      - ["Short", "short"]
      - ["Large Memory", "large-mem"]
      - ["GPU V100", "gpu-v100"]
      - ["GPU A100", "gpu-a100"]
      - ["GPU H100", "gpu-h100"]
  bc_num_hours:
    label: Walltime (Hours)
    help: |
      - Partition durations:
        - Short: 4 hours maximum
        - All others: 480 hours maximum
      - Exceeding walltime time will automatically stop this job.
    cacheable: false
    widget: number_field
    max: 480
    min: 1
    step: 1
    value: 1
  bc_num_slots: 1
  num_cpus:
    label: CPUs (Cores)
    help: |
      - CPU Paritions: allocate up to 64 cores
      - GPU Partitions:
        - V100 and A100: allocate up to 32 CPU cores per GPU
        - H100: allocate up to 12 CPU cores per GPU
    cacheable: false
    widget: number_field
    max: 96
    min: 1
    step: 1
    value: 1
  num_gpus:
    label: "GPUs"
    help: |
       - GPUs Available:
           - V100 and A100: 2 GPUs per node
           - H100: 8 GPUs per node
       - If requesting GPUs, you must select a GPU-enabled partition above
    cacheable: false
    widget: number_field
    max: 8
    min: 0
    step: 1
    value: 0
  version:
    widget: select
    label: "R version"
    help: |
       - This defines the version of R you want to load
    options:
      - [
          "4.4.0", "gcc/12.2.0 R/4.4.0 rstudio-server/2024.09.0-375"
        ]
  custom_element:
    class: "d-none"
    skip_label: true
    help: |
      <div class="card mb-3">
        <div class="card-header">
          Memory per CPU
        </div>
        <div class="card-body">
          <p class="mb-2">
            Total memory available ≈ <strong>CPUs x Mem/CPU</strong>.
          </p>
          <div class="table-responsive">
            <table class="table table-sm mb-0">
              <thead>
                <tr><td>Partition</td><td>Mem / CPU</td></tr>
              </thead>
              <tbody>
                <tr><td>Public</td><td>3800&nbsp;MB (≈ 3.71 GiB)</td></tr>
                <tr><td>Short</td><td>3800&nbsp;MB (≈ 3.71 GiB)</td></tr>
                <tr><td>Large Memory</td><td>30400&nbsp;MB (≈ 29.7 GiB)</td></tr>
                <tr><td>GPU-V100</td><td>3800&nbsp;MB (≈ 3.71 GiB)</td></tr>
                <tr><td>GPU-A100</td><td>15200&nbsp;MB (≈ 14.8 GiB)</td></tr>
                <tr><td>GPU-H100</td><td>10125&nbsp;MB (≈ 9.89 GiB)</td></tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>

      <div class="card">
        <div class="card-header">
          Note
        </div>
        <div class="card-body">
        RStudio will use the same R environment under your user account setup through the terminal. 
        Packages installed through RStudio will be availabe in the terminal and vice-versa (including submissions with <span class="bg-light text-black">sbatch</span>).
        If you need help with that setup, click below.
        </div>
      </div>

      <button class="btn btn-dark mt-3" type="button" data-toggle="collapse" data-target="#env_setup" aria-expanded="false" aria-controls="collapseExample">
        How to setup your R environment
      </button>

      <dl class="collapse" id="env_setup">
        <dt>Execute the follwing command in a terminal after logging into ARCC2:</dt>
        <dd>
          <ul style="list-style-type:none;">
            <li><span class="bg-light text-black">mkdir -p $HOME/.R && echo R_LIBS_USER="$HOME/.R" >> $HOME/.Renviron</span></li>
          </ul>
        </dd>

        <dt>This one-liner command is only need once and does the following:</dt>
        <dd>
          <ul>
            <li>creates a hidden directory in your home folder called <span class="bg-light text-black">.R</span></li>
            <li>creates a hidden environment file for R called <span class="bg-light text-black">.Renviron</span></li>
            <li>creates the environment variable <span class="bg-light text-black">R_LIBS_USER</span> in that file,
            so R will use that path (the new hidden directory <span class="bg-light text-black">.R</span>) as the location to install packages</li>
          </ul>

          The <span class="bg-light text-black">.Renviron</span> file is read when R loads. 
          See <a href="https://rstats.wtf/r-startup.html">this guide</a>  for an explanation of R's startup process.
        </dd>
      </dl>
